# ルート最適化に関する発見事項

## 2025-08-12 調査結果

### 1. 乗り換え時間の記録状況

現在のシステムでは、乗り換え時間が適切に記録されています：

**例：神谷町ルート（神田→銀座→神谷町）**
```json
{
  "trains": [
    {
      "line": "銀座線",
      "transfer_after": {
        "time": 4,  // 乗り換え徒歩時間
        "to_line": "日比谷線"
      }
    },
    {
      "line": "日比谷線",
      "wait_time": 6  // 電車待ち時間
    }
  ]
}
```

### 2. Yawaraへのルート最適化

#### 現在の課題
- 新御茶ノ水駅まで徒歩7分が長い
- 千代田線は直通で便利だが、初期徒歩が課題

#### 検討した代替案

1. **JRルート（神田→原宿）**
   - 総時間：29分（6分短縮）
   - 徒歩時間：同じ9分
   - 利点：総時間が短い
   - 欠点：乗り換え1回必要

2. **銀座線ルート（理論上）**
   - 神田→銀座線→赤坂見附→千代田線/半蔵門線
   - 問題点：
     - 乗り換え2回以上必要
     - 神田駅でのJR→銀座線乗り換えが複雑
     - 総時間が延びる可能性大

### 3. 推奨事項

1. **短期的対応**
   - JRルート（29分）の採用を検討
   - properties.jsonの更新

2. **中長期的対応**
   - Google Maps APIで複数ルートの自動比較機能
   - 時間帯別の最適ルート提案
   - リアルタイム運行情報の考慮

### 4. システム改善案

1. **複数ルート取得機能**
   ```python
   # Google Maps APIで複数の代替ルートを取得
   alternatives=true パラメータの活用
   ```

2. **ルート評価基準の追加**
   - 総時間
   - 徒歩時間
   - 乗り換え回数
   - 混雑度（時間帯別）

3. **ユーザー設定の反映**
   - 徒歩時間を最小化
   - 乗り換えを最小化
   - 総時間を最小化

### 5. 今後の作業

- [ ] JRルートの実装と検証
- [ ] 複数ルート比較機能の開発
- [ ] properties.jsonの最適化ロジック実装
- [ ] ユーザー設定機能の追加